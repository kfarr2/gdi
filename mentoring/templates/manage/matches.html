{% extends 'admin.html' %}

{% block page_title %}Welcome{% endblock %}

{% block content %}
{{ block.super }}
<h3>Scores</h3>
<table class="data">
    <thead>
        <tr>
            <td>&nbsp;</td>
            {% for mentor_response in mentor_responses %}
                <td><a href="{% url "surveys-response" mentor_response.response_id %}">{{ mentor_response.user.username }}</a></td>
            {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% for row in results %}
            <tr>
                <td>
                {% if row|length %}
                <a href="{% url "surveys-response" row.0.mentee_response.response_id %}">{{ row.0.mentee_response.user.username }}</a></td>
                {% endif %}
                {% for col in row %}
                    <td class="number">{{ col.score }}</td>
                {% endfor %}
            </tr>
        {% endfor %}
    </tbody>
</table>

<table class="panel-view"><tr><td>

<h3>Suitors</h3>
<ul>
{% for mentee in unmatched_mentees %}
    <li><a href="{% url "surveys-response" mentee.response_id %}">{{ mentee.user.username }}</a>
        <ul>
        {% for pair in mentee.suitors %}
            <li>
                {{ pair.score }} {{ pair.mentor.user.username }}
                <form method="post" action="{% url 'matches-engage' %}" class="form-button">
                    {% csrf_token %}
                    <input type="hidden" name="mentee_id" value="{{ mentee.pk }}" />
                    <input type="hidden" name="mentor_id" value="{{ pair.mentor.pk }}" />
                    <input type="submit" name="submit" value="Engage" />
                </form>
            </li>
        {% endfor %}
        </ul>
    </li>
{% endfor %}
</ul>

</td>
<td>

<h3>Engagements</h3>
<ul>
{% for mentor in engagements %}
    <li>
        {{ mentor.mentor_username }}
        <ul>
        {% for mentee in mentor.mentees %}
            <li>{{ mentee.mentee_username }}
                <br />
                <form method="post" action="{% url 'matches-marry' %}" class="form-button">
                    {% csrf_token %}
                    <input type="hidden" name="mentee_id" value="{{ mentee.mentee_id }}" />
                    <input type="hidden" name="mentor_id" value="{{ mentee.mentor_id }}" />
                    <input type="submit" name="submit" value="Marry" />
                </form>

                <form method="post" action="{% url 'matches-breakup' %}" class="form-button">
                    {% csrf_token %}
                    <input type="hidden" name="mentee_id" value="{{ mentee.mentee_id }}" />
                    <input type="hidden" name="mentor_id" value="{{ mentee.mentor_id }}" />
                    <input type="submit" name="submit" value="Breakup" />
                </form>
            </li>
        {% endfor %}
        </ul>
    </li>
{% empty %}
    <li>No engagements</li>
{% endfor %}
</ul>

</td>
<td>
<h3>Marriages</h3>
<ul>
{% for mentor in marriages %}
    <li>
        {{ mentor.mentor_username }}
        <ul>
        {% for mentee in mentor.mentees %}
            <li>{{ mentee.mentee_username }}
                <br />
                <form method="post" action="{% url 'matches-divorce' %}" class="form-button">
                    {% csrf_token %}
                    <input type="hidden" name="mentee_id" value="{{ mentee.mentee_id }}" />
                    <input type="hidden" name="mentor_id" value="{{ mentee.mentor_id }}" />
                    <input type="submit" name="submit" value="Divorce" />
                </form>

                <form method="post" action="{% url 'matches-complete' %}" class="form-button">
                    {% csrf_token %}
                    <input type="hidden" name="mentee_id" value="{{ mentee.mentee_id }}" />
                    <input type="hidden" name="mentor_id" value="{{ mentee.mentor_id }}" />
                    <input type="submit" name="submit" value="Complete" />
                </form>
            </li>
        {% endfor %}
        </ul>
    </li>
{% empty %}
    <li>No marriages</li>
{% endfor %}
</ul>


</td>
</tr>
</table>
{% endblock %}

