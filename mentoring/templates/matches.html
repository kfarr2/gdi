{% extends 'admin.html' %}

{% block page_title %}Welcome{% endblock %}

{% block content %}
{{ block.super }}
<h2>Scores</h2>
<table>
    <thead>
        <tr>
            <td>&nbsp;</td>
            {% for mentor_response in mentor_responses %}
                <td><a href="{% url "surveys-response" mentor_response.response_id %}">{{ mentor_response.user.username }}</a></td>
            {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% for row in results %}
            <tr>
                <td>
                {% if row|length %}
                <a href="{% url "surveys-response" row.0.mentee_response.response_id %}">{{ row.0.mentee_response.user.username }}</a></td>
                {% endif %}
                {% for col in row %}
                    <td>{{ col.score }}</td>
                {% endfor %}
            </tr>
        {% endfor %}
    </tbody>
</table>

<table class="panel-view"><tr><td>

<h2>Suitors</h2>
<ul>
{% for mentee in unmatched_mentees %}
    <li>{{ mentee.user.username }} {{ mentee.pk }}
        <ul>
        {% for suitor in mentee.suitors %}
            <li>
                {{ suitor.user.username }} {{ suitor.pk }} 
                <form method="post" action="{% url 'matches-engage' %}" class="form-button">
                    {% csrf_token %}
                    <input type="hidden" name="mentee_id" value="{{ mentee.pk }}" />
                    <input type="hidden" name="mentor_id" value="{{ suitor.pk }}" />
                    <input type="submit" name="submit" value="Engage" />
                </form>
            </li>
        {% endfor %}
        </ul>
    </li>
{% endfor %}
</ul>

</td>
<td>

<h2>Engagements</h2>
<ul>
{% for mentor in engagements %}
    <li>
        {{ mentor.mentor_username }}
        <ul>
        {% for mentee in mentor.mentees %}
            <li>{{ mentee.mentee_username }}
                <form method="post" action="{% url 'matches-marry' %}" class="form-button">
                    {% csrf_token %}
                    <input type="hidden" name="mentee_id" value="{{ mentee.mentee_id }}" />
                    <input type="hidden" name="mentor_id" value="{{ mentee.mentor_id }}" />
                    <input type="submit" name="submit" value="Marry" />
                </form>

                <form method="post" action="{% url 'matches-breakup' %}" class="form-button">
                    {% csrf_token %}
                    <input type="hidden" name="mentee_id" value="{{ mentee.mentee_id }}" />
                    <input type="hidden" name="mentor_id" value="{{ mentee.mentor_id }}" />
                    <input type="submit" name="submit" value="Breakup" />
                </form>
            </li>
        {% endfor %}
        </ul>
    </li>
{% endfor %}
</ul>

</td>
<td>
<h2>Marriages</h2>
<ul>
{% for mentor in marriages %}
    <li>
        {{ mentor.mentor_username }}
        <ul>
        {% for mentee in mentor.mentees %}
            <li>{{ mentee.mentee_username }}
                <form method="post" action="{% url 'matches-divorce' %}" class="form-button">
                    {% csrf_token %}
                    <input type="hidden" name="mentee_id" value="{{ mentee.mentee_id }}" />
                    <input type="hidden" name="mentor_id" value="{{ mentee.mentor_id }}" />
                    <input type="submit" name="submit" value="Divorce" />
                </form>

                <form method="post" action="{% url 'matches-complete' %}" class="form-button">
                    {% csrf_token %}
                    <input type="hidden" name="mentee_id" value="{{ mentee.mentee_id }}" />
                    <input type="hidden" name="mentor_id" value="{{ mentee.mentor_id }}" />
                    <input type="submit" name="submit" value="Complete" />
                </form>
            </li>
        {% endfor %}
        </ul>
    </li>
{% endfor %}
</ul>


</td>
</tr>
</table>
<h2>Completed</h2>
<ul>
{% for mentor in completed %}
    <li>
        {{ mentor.mentor_username }}
        <ul>
        {% for mentee in mentor.mentees %}
            <li>{{ mentee.mentee_username }}</li>
        {% endfor %}
        </ul>
    </li>
{% endfor %}
</ul>

{% endblock %}

